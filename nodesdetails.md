# ノード詳細ガイド

このページは、ロボットアームの自動化プロトコルで使用する各種ノードの使い方について説明するためのページです。

## 1. はじめに

自動化のプロトコルを自分用にカスタマイズするには、各種ノードの役割や設定が非常に重要です。このガイドでは、基本的なノードの種類や、それらの構成方法、実際の活用例について解説します。

## 2. ノードの概要

主なノードの種類を以下に紹介します：

- **移動系**  
  ロボットアームを移動させるためのノードです。

- **データ処理**  
  ロボットアームがウェルプレートやチップケース、シャーレのコロニーの座標を認識するために使用するノードです。位置座標を行列としてに変換します。

- **制御**  
  現在はループのみが実装されています。

## 3. ノードの詳細
### 3.1 移動系

- 指定座標移動<br>
ロボットアームを指定した座標（X,Y,Z軸など）に移動させます。

<div style="border-left: 4px solid #ffd700; background:rgb(28, 27, 25); padding: 15px; margin: 20px 0; border-radius: 5px;">
  <p style="margin: 0; font-size: 1.1em;">
    💡 <strong>Tips:</strong> 
    左バーの中にある制御のページにいくとアームの現在の座標をコピーすることができます。指定座標移動ノードについている「座標貼り付け」のボタンによってペーストも実施できます。
  </p>
</div>

- チップ排出<br>
ロボットアームの先端からチップを排出するノードです。指定座標移動でチップゴミ箱などに移動と組み合わせることで指定の位置にチップを捨てることができます。

### 3.2 データ処理

- データフレーム作成<br>
ウェルプレートやチップケースのような行列で存在するものを座標として認識するためのノードです。共通ｚはアームの高さを表します。ここで作られた座標はノード上についている「データフレームを渡す」の点と

詳しい用語解説<br>

*オブジェクトタイプ*  
今回認識したい機器の名前を書きます。たとえばwellplate_1などが考えられます。<br>

*行数 列数*  
今回認識したい機器の座標の行列の行数と列数を認識します。設置させていただく際には、ロボットと正対するときの前後が列、左右が行となるように設置させていただいています。

<div style="border-left: 4px solid #ffd700; background:rgb(28, 27, 25); padding: 15px; margin: 20px 0; border-radius: 5px;">
  <p style="margin: 0; font-size: 1.1em;">
    💡 <strong>Tips:</strong> <br>
    ロボットと接続状態にある場合は左上の制御のページで、「+」と「-」のボタンを押すことでロボットの位置を移動させることができます。<br>
    <br>そのようにして得た座標のをデータフレームに入力することでロボットがウェルプレートの穴すべての座標を認識できます。
  </p>
</div>

- コロニー認識<br>
指定の場所にシャーレを置いてあることを条件に、シャーレの中にあるコロニーの数を数えます。


### 3.3 制御
- ループ<br>
右側につながっている連なるノードを繰り返します。右側の点から次のノードにつなぐことができます。繰り返し動作の回数は実行の際に指定します。また繰り返しが終わった際には、下の点（ループ外へ）からつながっているノードを実行します。


## 4. ノードを使って自動化のプロトコルを組む
コロニーピッキングを想定したノードを見ながら作り方について学んでみましょう。
![sample nodes](/robotarm-doc/images/nodedetails_samplenodes.png)
基本的には右に行くほど次のノードに進み、縦はループにおけるノードの実施順を表します。
### 4.1 チップケースのデータフレームを作成する
最初のノードは「データフレーム作成」を用いたチップケースの穴の座標を集めた行列を作ります。
<div style="border-left: 4px solid #ffd700; background:rgb(28, 27, 25); padding: 15px; margin: 20px 0; border-radius: 5px;">
  <p style="margin: 0; font-size: 1.1em;">
    💡 <strong>Tips:</strong> <br>
   左右にある点は「in」「out」を表し、inにはその前に実行するノードをつなげ、outには次に実行するノードをつなげます。<br>
    <br>つまり基本的にはそれぞれのノードのin の点はoutにつながり、outの点はinにつながるということになります。
  </p>
</div>

### 4.2 シャーレの中のコロニーを認識する<br>
次のノードでは、コロニーを座標に変換して認識しています。コロニーの座標をループノードの中の「データフレーム移動」につなぐことでループのなかで一個ずつコロニーをピッキングしてもらいます。

### 4.3 レプリカ1を認識する<br>
次のノードでは、レプリカの座標を認識します。シャーレでレプリケーションをする際は、シャーレの中で四角ができるように座標をしてすることで方眼のようにレプリケーションを実施できます。



### 4.4 ウェルプレートを認識する<br>
次のノードでは、ウェルプレートの座標を認識します。行と列について間違えないようにしましょう。

### 4.5 ループを行うノードを作る<br>
次のノードでは、実際の自動化のプロトコルを作っていきます。

今回は「データフレーム移動」を四つつなげることで、ループを実現しています。移動する座標は「データフレームを渡す」という点を「データフレームを受け取る」という点につなげることで実現します。

チップケースに移動してチップをつける <br>
→ コロニーに移動してピッキング <br>
→ レプリカ1に移動してレプリケーション<br>
 → ウェルプレートに移動して落とす <br>
 
 が今回は行列の座標を受け取って実施しています。

その後、「指定座標移動」でチップを捨てるゴミ箱の上まで移動して、チップを排出しています。


### 4.5 ループが終わった後指定座標に移動させる<br>
ループが終わった後に実施したいノードは、ループノードの「ループ外へ」のノードと「in」をつなげることで実施できます。今回は、指定座標に移動してもらうために「指定座標移動」に好きな座標を入力して終了させています。


## 5. まとめ

このガイドは、ノードの基本概念とその活用に関する入門として作成されています。各ノードの詳細な仕様や、より実践的なサンプルは今後のアップデートで追加予定です。




